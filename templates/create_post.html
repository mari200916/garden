{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç | –°–∞–¥ –º–µ—á—Ç—ã</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
<header>
    <h1>–°–ê–î –ú–ï–ß–¢–´!</h1>
    <div class="buttons">
        <button onclick="location.href='{% url 'index' %}'">–ì–ª–∞–≤–Ω–∞—è</button>
        <button id="theme-toggle">üåû / üåú</button>
    </div>
</header>

<main style="display:flex; justify-content:center; margin-top:20px;">
    <div class="card" style="max-width:500px; width:90%;">
        <h2>–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</h2>
        <form method="POST" enctype="multipart/form-data" class="post-form">
            {% csrf_token %}

            <p>
                {{ form.title.label_tag }}
                {{ form.title }}
            </p>

            <p>
                {{ form.text.label_tag }}
                {{ form.text }}
            </p>

            <p>
                <label class="file-upload">
                    <span>üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
                    {{ form.image }}
                    <img id="image-preview" style="display:none; margin-top:10px; max-width:100%; border-radius:8px;">
                </label>
            </p>

            <button type="submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </form>
    </div>
</main>

<script>
const toggleBtn = document.getElementById('theme-toggle');
const body = document.body;
if(localStorage.getItem('theme') === 'light'){ body.classList.add('light-theme'); }

toggleBtn.addEventListener('click', () => {
    body.classList.toggle('light-theme');
    if(body.classList.contains('light-theme')){
        localStorage.setItem('theme', 'light');
    } else {
        localStorage.setItem('theme', 'dark');
    }
});

// === –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ===
const fileInput = document.querySelector('.file-upload input[type="file"]');
const preview = document.getElementById('image-preview');

fileInput.addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        }
        reader.readAsDataURL(file);
    } else {
        preview.style.display = 'none';
    }
});
</script>

</body>
</html>
